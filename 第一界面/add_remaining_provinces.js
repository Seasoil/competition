// 添加剩余省份数据到现有JSON文件
const fs = require('fs');

// 剩余省份数据
const remainingProvinces = {
  "东北地区": {
    "辽宁省": [
      "法库县", "康平县", "长海县", "台安县", "抚顺县", "黑山县", "义县", "彰武县", "辽阳县", "盘山县", 
      "铁岭县", "昌图县", "西丰县", "朝阳县", "建平县", "绥中县", "建昌县",
      "本溪满族自治县", "桓仁满族自治县", "清原满族自治县", "新宾满族自治县", "岫岩满族自治县", 
      "宽甸满族自治县", "阜新蒙古族自治县", "喀喇沁左翼蒙古族自治县"
    ],
    "吉林省": [
      "农安县", "永吉县", "梨树县", "东丰县", "东辽县", "通化县", "辉南县", "柳河县", "抚松县", "靖宇县", 
      "镇赉县", "通榆县", "乾安县", "长岭县", "汪清县", "安图县",
      "前郭尔罗斯蒙古族自治县", "长白朝鲜族自治县", "伊通满族自治县"
    ],
    "黑龙江省": [
      "宾县", "巴彦县", "方正县", "依兰县", "通河县", "延寿县", "木兰县", "龙江县", "富裕县", "克东县", 
      "克山县", "泰来县", "甘南县", "拜泉县", "依安县", "林口县", "桦川县", "桦南县", "汤原县", "肇源县", 
      "肇州县", "林甸县", "嘉荫县", "南岔县", "汤旺县", "丰林县", "大箐山县", "鸡东县", "萝北县", "绥滨县", 
      "集贤县", "宝清县", "友谊县", "饶河县", "勃利县", "望奎县", "兰西县", "青冈县", "绥棱县", "明水县",
      "庆安县", "孙吴县", "逊克县", "呼玛县", "塔河县", "杜尔伯特蒙古族自治县"
    ]
  },
  "华东地区": {
    "江苏省": [
      "丰县", "沛县", "睢宁县", "如东县", "灌云县", "灌南县", "东海县", "涟水县", "金湖县", "盱眙县", 
      "响水县", "滨海县", "阜宁县", "射阳县", "建湖县", "宝应县", "沭阳县", "泗洪县", "泗阳县"
    ],
    "浙江省": [
      "桐庐县", "淳安县", "象山县", "宁海县", "苍南县", "永嘉县", "平阳县", "泰顺县", "文成县", "新昌县", 
      "德清县", "安吉县", "长兴县", "海盐县", "嘉善县", "浦江县", "武义县", "磐安县", "常山县", "开化县", 
      "龙游县", "天台县", "三门县", "仙居县", "缙云县", "青田县", "遂昌县", "松阳县", "庆元县", "云和县", 
      "岱山县", "嵊泗县", "景宁畲族自治县"
    ],
    "安徽省": [
      "肥西县", "肥东县", "长丰县", "庐江县", "南陵县", "五河县", "固镇县", "怀远县", "凤台县", "寿县", 
      "含山县", "和县", "当涂县", "濉溪县", "枞阳县", "怀宁县", "岳西县", "太湖县", "宿松县", "望江县", 
      "歙县", "休宁县", "黟县", "祁门县", "颍上县", "临泉县", "阜南县", "太和县", "萧县", "砀山县", 
      "灵璧县", "泗县", "全椒县", "来安县", "定远县", "凤阳县", "霍邱县", "霍山县", "金寨县", "舒城县", 
      "郎溪县", "泾县", "绩溪县", "旌德县", "青阳县", "石台县", "东至县", "蒙城县", "涡阳县", "利辛县"
    ],
    "福建省": [
      "闽侯县", "连江县", "罗源县", "闽清县", "永泰县", "平潭县", "仙游县", "沙县", "清流县", "宁化县", 
      "大田县", "尤溪县", "明溪县", "建宁县", "将乐县", "泰宁县", "惠安县", "安溪县", "永春县", "德化县", 
      "金门县", "云霄县", "漳浦县", "诏安县", "长泰县", "东山县", "华安县", "南靖县", "平和县", "顺昌县", 
      "浦城县", "光泽县", "松溪县", "政和县", "长汀县", "上杭县", "武平县", "连城县", "霞浦县", "古田县", 
      "屏南县", "寿宁县", "周宁县", "柘荣县"
    ]
  }
};

// 气候模式
const climatePatterns = {
  "华北地区": [8.2, 12.5, 18.3, 25.6, 42.8, 68.9, 85.4, 92.1, 78.6, 45.2, 28.7, 15.3, 12.8, 18.4, 22.1, 35.6, 18.9, 12.4, 8.7, 5.2, 3.8, 2.1, 4.6, 6.8],
  "东北地区": [3.2, 5.8, 12.4, 28.7, 45.6, 78.9, 124.3, 156.7, 89.2, 42.1, 18.6, 7.4, 5.1, 8.9, 15.7, 24.3, 38.6, 52.8, 34.7, 21.4, 9.8, 4.6, 2.8, 3.9],
  "华东地区": [45.2, 68.7, 89.3, 112.6, 145.8, 198.4, 234.7, 187.3, 156.9, 98.2, 67.4, 42.8, 38.6, 52.1, 71.3, 89.7, 76.2, 58.9, 41.3, 28.7, 19.4, 15.2, 22.8, 35.6],
  "华中地区": [38.6, 56.4, 78.9, 98.7, 134.2, 189.3, 245.6, 198.4, 145.7, 89.2, 54.3, 32.1, 28.7, 42.3, 58.9, 76.4, 98.1, 112.6, 67.8, 45.2, 28.4, 19.7, 25.3, 31.8],
  "华南地区": [32.4, 58.7, 89.6, 142.3, 198.7, 267.4, 189.2, 156.8, 134.6, 78.9, 42.1, 28.7, 25.3, 41.6, 67.8, 98.4, 125.7, 89.3, 56.2, 38.4, 24.1, 18.9, 21.7, 29.8],
  "西南地区": [12.4, 23.7, 45.8, 78.9, 124.6, 167.3, 198.7, 156.2, 89.4, 52.1, 28.6, 15.7, 13.2, 19.8, 34.7, 58.2, 87.3, 112.4, 76.8, 45.9, 24.1, 16.3, 11.8, 14.6],
  "西北地区": [15.7, 24.8, 38.6, 52.4, 67.9, 89.3, 112.6, 98.7, 76.2, 45.8, 28.4, 18.9, 16.2, 21.7, 29.8, 38.6, 52.1, 67.4, 48.3, 32.7, 19.6, 14.2, 12.8, 16.4]
};

// 生成降水数据
function generatePrecipitationData(countyName, region) {
  const base = climatePatterns[region] || climatePatterns["华北地区"];
  const years = {};
  
  for (let year = 2023; year <= 2025; year++) {
    years[year.toString()] = base.map(value => {
      const variation = (Math.random() - 0.5) * 0.3;
      const newValue = value * (1 + variation);
      return Math.round(newValue * 10) / 10;
    });
  }
  
  return years;
}

// 读取现有数据
console.log('📖 读取现有数据文件...');
const data = JSON.parse(fs.readFileSync('./data/precipitation_data_complete.json', 'utf8'));

let addedCount = 0;

// 添加剩余省份数据
for (const region in remainingProvinces) {
  if (!data.regions[region]) {
    data.regions[region] = {};
  }
  
  for (const province in remainingProvinces[region]) {
    if (!data.regions[region][province]) {
      data.regions[region][province] = {};
    }
    
    const counties = remainingProvinces[region][province];
    counties.forEach(county => {
      if (!data.regions[region][province][county]) {
        data.regions[region][province][county] = generatePrecipitationData(county, region);
        addedCount++;
      }
    });
    
    console.log(`✅ ${province}: ${counties.length} 个县级单位`);
  }
}

// 更新元数据
data.metadata.total_counties = addedCount;
data.metadata.last_updated = "2025-01-17";

// 保存更新后的数据
fs.writeFileSync('./data/precipitation_data_complete.json', JSON.stringify(data, null, 2), 'utf8');

console.log(`\n🎉 成功添加 ${addedCount} 个县级单位！`);
console.log('📁 文件已更新: ./data/precipitation_data_complete.json');
console.log('💾 文件大小: ' + (fs.statSync('./data/precipitation_data_complete.json').size / 1024 / 1024).toFixed(2) + ' MB');
