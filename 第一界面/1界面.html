<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å»¿å››</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #f0f9eb, #c8e6c9);
            font-family: 'Microsoft YaHei', sans-serif;
        }
        .main-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: rgba(124, 169, 56, 0.95);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 40px;
            backdrop-filter: blur(6px);
        }

        .nav-buttons {
            display: flex;
            gap: 25px;
            margin-left: auto;
        }

        .nav-button {
            padding: 12px 28px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: #04532c;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-button:hover {
            background: #1eb323;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.25);
        }

        .nav-button i {
            font-size: 18px;
        }
        #chart-container {
            margin-top: 100px; /* ç»™å¯¼èˆªæ ç•™å‡ºç©ºé—´ */
            height: calc(100vh - 100px);
        }

        #time-axis {
            position: fixed;
            right: 40px;
            top: 50%;
            transform: translateY(-50%);
            height: 70vh;
            width: 50px;
            background: #fff;
            border-radius: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 2;
            padding: 15px 5px;
        }

        #time-slider {
            -webkit-appearance: slider-vertical;
            width: 100%;
            height: 100%;
            margin: 0;
            cursor: pointer;
            background: transparent;
            transition: transform 0.1s ease-out;
        }

        #time-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: #0c9d10;
            border-radius: 50%;
            border: 3px solid #fff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        .term-tooltip {
            position: absolute;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            width: 280px;
            pointer-events: none;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform-origin: center;
            border: 1px solid #eee;
            z-index: 3;
        }

        .term-tooltip h3 {
            color: #098949;
            margin: 0 0 12px 0;
            font-size: 20px;
        }

        .term-tooltip p {
            color: #666;
            margin: 8px 0;
            line-height: 1.6;
            font-size: 14px;
        }
    </style>
    <script src="./js/echarts (2).js"></script>
    <script src="./js/anime.min.js"></script>
    <script src="./js/lodash.min.js"></script>
</head>

<body>
    <nav class="main-nav">
        <h1 style="color: #2c7a53; font-size: 24px;">å†œäº‹èŠ‚æ°”å¯è§†åŒ–ç³»ç»Ÿ</h1>
        <div class="nav-buttons">
            <button class="nav-button" onclick="window.location.href='../index.html'">
                <i>ğŸ“Š</i>ä¸»ç•Œé¢
            </button>
            <button class="nav-button" onclick="window.location.href='../ç¬¬äºŒç•Œé¢/å…³ç³»å›¾.html'">
                <i>ğŸŒ¾</i>ç¬¬äºŒç•Œé¢
            </button>
            <button class="nav-button" onclick="window.location.href='../ç¬¬ä¸‰ç•Œé¢/äººç•Œé¢.html'">
                <i>ğŸ“…</i>ç¬¬ä¸‰ç•Œé¢
            </button>
            <button class="nav-button" onclick="window.location.href='./èŠ‚æ°”ç•Œé¢/å†œè°š.html'">
                <i>ğŸŒ±</i>å†œè°šç•Œé¢
            </button>
        </div>
    </nav>

    <div id="chart-container"></div>
    <div id="time-axis">
        <input type="range" id="time-slider" min="0" max="365" value="0" orient="vertical">
    </div>
    <div id="term-tooltip" class="term-tooltip"></div>

    <script>
        // å­£èŠ‚é¢œè‰²æ˜ å°„
        const seasonColors = {
            'æ˜¥': '#8bc34a',
            'å¤': '#ffb74d',
            'ç§‹': '#f44336',
            'å†¬': '#2196f3'
        };
        const navButtons = document.querySelectorAll('.nav-button');

            navButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    // æ·»åŠ é¡µé¢è¿‡æ¸¡åŠ¨ç”»
                    anime({
                        targets: 'body',
                        opacity: 0,
                        duration: 400,
                        easing: 'easeInOutQuad',
                        complete: () => {
                            window.location.href = button.onclick.toString().match(/'(.*?)'/)[1];
                        }
                    });
                });
            });
        // èŠ‚æ°”æ•°æ®
        const solarTermsData = [
            { name: 'ç«‹æ˜¥', season: 'æ˜¥', date: '2æœˆ3-5æ—¥', desc: 'æ˜¥è€•å¤‡è€•å¼€å§‹ï¼Œæ£€æŸ¥å†œå…·ï¼Œå‡†å¤‡æ—©ç¨»è‚²ç§§' },
            { name: 'é›¨æ°´', season: 'æ˜¥', date: '2æœˆ18-20æ—¥', desc: 'å†¬å°éº¦å¼€å§‹è¿”é’ï¼Œæ±Ÿå—åœ°åŒºæ²¹èœè¿½è‚¥' },
            { name: 'æƒŠè›°', season: 'æ˜¥', date: '3æœˆ5-7æ—¥', desc: 'æ˜¥è€•å…¨é¢å±•å¼€ï¼Œé˜²æ²»è¶Šå†¬å®³è™«ï¼Œæœæ ‘ä¿®å‰ª' },
            { name: 'æ˜¥åˆ†', season: 'æ˜¥', date: '3æœˆ20-22æ—¥', desc: 'æ˜¥æ’­ä½œç‰©æ’­ç§å…³é”®æœŸï¼Œå°éº¦è¿›å…¥æ‹”èŠ‚æœŸ' },
            { name: 'æ¸…æ˜', season: 'æ˜¥', date: '4æœˆ4-6æ—¥', desc: 'æ—©ç¨»æ’ç§§ï¼Œç‰ç±³æ’­ç§ï¼ŒèŒ¶å›­æ˜¥ç®¡å…³é”®æœŸ' },
            { name: 'è°·é›¨', season: 'æ˜¥', date: '4æœˆ19-21æ—¥', desc: 'æ°´ç¨»ç§»æ ½ï¼Œæ£‰èŠ±æ’­ç§ï¼Œé˜²æ²»å°éº¦èµ¤éœ‰ç—…' },

            { name: 'ç«‹å¤', season: 'å¤', date: '5æœˆ5-7æ—¥', desc: 'å¤æ”¶ä½œç‰©çŒæµ†å…³é”®æœŸï¼Œæ—©ç¨»åˆ†è˜–è‚¥æ–½ç”¨' },
            { name: 'å°æ»¡', season: 'å¤', date: '5æœˆ20-22æ—¥', desc: 'å°éº¦ç±½ç²’é¥±æ»¡ï¼Œæ²¹èœæ”¶è·ï¼Œæ°´ç¨»æ™’ç”°æ§è˜–' },
            { name: 'èŠ’ç§', season: 'å¤', date: '6æœˆ5-7æ—¥', desc: 'å¤æ”¶å¤ç§å…³é”®æœŸï¼ŒæŠ¢æ”¶å°éº¦ï¼Œæ’­ç§æ™šç¨»' },
            { name: 'å¤è‡³', season: 'å¤', date: '6æœˆ21-22æ—¥', desc: 'ä¸­ç¨»è¿½è‚¥ï¼Œæ£‰èŠ±æ•´æï¼Œé˜²æ²»æ°´ç¨»çº¹æ¯ç—…' },
            { name: 'å°æš‘', season: 'å¤', date: '7æœˆ6-8æ—¥', desc: 'æ—©ç¨»æ”¶å‰²ï¼Œæ™šç¨»ç§»æ ½ï¼Œç‰ç±³è¿½è‚¥' },
            { name: 'å¤§æš‘', season: 'å¤', date: '7æœˆ22-24æ—¥', desc: 'åŒå­£ç¨»åŒºæŠ¢æ”¶æŠ¢ç§ï¼ŒæŠ—æ—±ä¿è‹—å…³é”®æœŸ' },

            { name: 'ç«‹ç§‹', season: 'ç§‹', date: '8æœˆ7-9æ—¥', desc: 'æ°´ç¨»å­•ç©—æœŸç®¡ç†ï¼Œç‰ç±³æˆç²‰æœŸï¼Œæ£‰èŠ±æ‰“é¡¶' },
            { name: 'å¤„æš‘', season: 'ç§‹', date: '8æœˆ22-24æ—¥', desc: 'æ°´ç¨»é˜²æ—©è¡°ï¼Œç‰ç±³çŒæµ†æœŸç®¡ç†ï¼Œæœå›­æ–½è‚¥' },
            { name: 'ç™½éœ²', season: 'ç§‹', date: '9æœˆ7-9æ—¥', desc: 'æ™šç¨»æŠ½ç©—æ‰¬èŠ±æœŸï¼Œå†¬å°éº¦å¤‡è€•ï¼Œé‡‡æ‘˜ç§‹èŒ¶' },
            { name: 'ç§‹åˆ†', season: 'ç§‹', date: '9æœˆ22-24æ—¥', desc: 'ç§‹æ”¶ç§‹ç§å…³é”®æœŸï¼Œæ”¶è·ä¸­ç¨»ï¼Œæ’­ç§å†¬å°éº¦' },
            { name: 'å¯’éœ²', season: 'ç§‹', date: '10æœˆ8-9æ—¥', desc: 'æ”¶è·æ™šç¨»ï¼Œæ’­ç§æ²¹èœï¼Œæœæ ‘ç§‹å­£ä¿®å‰ª' },
            { name: 'éœœé™', season: 'ç§‹', date: '10æœˆ23-24æ—¥', desc: 'å†¬å°éº¦å‡ºè‹—ç®¡ç†ï¼Œè”¬èœå¤§æ£šé˜²å¯’å‡†å¤‡' },

            { name: 'ç«‹å†¬', season: 'å†¬', date: '11æœˆ7-8æ—¥', desc: 'å†œç”°æ°´åˆ©å»ºè®¾ï¼Œæ²¹èœè¶Šå†¬ç®¡ç†ï¼Œæœæ ‘åŸ¹åœŸ' },
            { name: 'å°é›ª', season: 'å†¬', date: '11æœˆ22-23æ—¥', desc: 'å†¬å°éº¦å†¬çŒï¼Œè”¬èœå‚¨è—ï¼Œæœå›­æ¸…å›­æ¶ˆæ¯’' },
            { name: 'å¤§é›ª', season: 'å†¬', date: '12æœˆ6-8æ—¥', desc: 'å†œç”°ä¼‘è€•å…»åœ°ï¼Œæ¸©å®¤å¤§æ£šæ¸©åº¦è°ƒæ§' },
            { name: 'å†¬è‡³', season: 'å†¬', date: '12æœˆ21-23æ—¥', desc: 'ç§¯è‚¥é€ è‚¥ï¼Œæœæ ‘é˜²å†»ï¼Œå†¬å­£ä¿®å‰ª' },
            { name: 'å°å¯’', season: 'å†¬', date: '1æœˆ5-7æ—¥', desc: 'è¶Šå†¬ä½œç‰©é˜²å†»å®³ï¼Œæ¸©å®¤ä½œç‰©å…‰ç…§ç®¡ç†' },
            { name: 'å¤§å¯’', season: 'å†¬', date: '1æœˆ20-21æ—¥', desc: 'å†œä¸šæœºæ¢°ä¿å…»ï¼Œæ˜¥è€•ç‰©èµ„å‡†å¤‡ï¼ŒåœŸå£¤æ”¹è‰¯' }
        ];

        // åˆå§‹åŒ–å›¾è¡¨
        const chart = echarts.init(document.getElementById('chart-container'));
        let activeTerm = null;
        let isAnimating = false;
        let hoverTimer = null;

        const slider = document.getElementById('time-slider');
        const tooltip = document.getElementById('term-tooltip');

        // ä¼˜åŒ–æ—¶é—´è½´äº¤äº’
        slider.addEventListener('input', _.throttle(e => {
            if (isAnimating) return;
            isAnimating = true;

            const day = parseInt(e.target.value);
            const term = findNearestTerm(day);

            anime({
                targets: slider,
                value: getTermDay(term.date),
                duration: 400,
                easing: 'easeOutQuad',
                round: true
            });

            updateHighlight(term);
            showTooltip(term, day);

            setTimeout(() => isAnimating = false, 150);
        }, 20));

        // é¼ æ ‡æ‚¬åœäº¤äº’
        chart.on('mouseover', ({ name }) => {
            const term = solarTermsData.find(t => t.name === name);
            clearTimeout(hoverTimer);
            showTooltip(term, getTermDay(term.date));
        });

        chart.on('mouseout', () => {
            hoverTimer = setTimeout(() => {
                anime({
                    targets: tooltip,
                    opacity: 0,
                    scale: 0.9,
                    duration: 200
                });
            }, 200);
        });

        // ç‚¹å‡»è·³è½¬åŠŸèƒ½
        chart.on('click', ({ name }) => {
            const term = solarTermsData.find(t => t.name === name);
            window.location.href = `./èŠ‚æ°”ç•Œé¢/ç«‹å†¬.html`;
        });

        // æ ¸å¿ƒåŠŸèƒ½å‡½æ•°
        function updateHighlight(term) {
            chart.dispatchAction({
                type: 'highlight',
                name: term.name,
                animation: { duration: 300, easing: 'quadraticOut' }
            });
            if (activeTerm) {
                chart.dispatchAction({ type: 'downplay', name: activeTerm });
            }
            activeTerm = term.name;
        }

        function showTooltip(term, day) {
            clearTimeout(hoverTimer);
            const angle = (day / 365) * 360 - 90;
            const x = Math.cos(angle * Math.PI / 180) * 200 + window.innerWidth / 2;
            const y = Math.sin(angle * Math.PI / 180) * 200 + window.innerHeight / 2;

            anime({
                targets: tooltip,
                left: `${x}px`,
                top: `${y}px`,
                opacity: 1,
                scale: [0.95, 1],
                duration: 300,
                easing: 'easeOutBack',
                begin: () => {
                    tooltip.innerHTML = `
                        <h3 style="color:${seasonColors[term.season]}">${term.name}</h3>
                        <p>ğŸ“… ${term.date}</p>
                        <p>${term.desc}</p>
                    `;
                }
            });
        }

        // å·¥å…·å‡½æ•°
        function getTermDay(dateStr) {
            const [month, days] = dateStr.split('æœˆ');
            const [startDay] = days.replace('æ—¥', '').split('-').map(Number);
            return (parseInt(month) - 1) * 30 + startDay;
        }

        function findNearestTerm(day) {
            return solarTermsData.reduce((nearest, term) =>
                Math.abs(getTermDay(term.date) - day) <
                    Math.abs(getTermDay(nearest.date) - day) ? term : nearest
            );
        }

        // EChartsé…ç½®
        const option = {
            title: {
                text: 'å»¿å››èŠ‚æ°”æ—¶é—´åˆ†å¸ƒ',
                subtext: 'æ»‘åŠ¨å³ä¾§æ—¶é—´è½´æ¢ç´¢èŠ‚æ°”',
                left: 'center',
                textStyle: {
                    color: '#2c7a53',
                    fontSize: 24,
                    fontWeight: 'bold'
                }
            },
            series: [{
                type: 'pie',
                radius: ['20%', '75%'],
                roseType: 'radius',
                itemStyle: {
                    color: ({ data }) => seasonColors[data.season],
                    borderWidth: 2,
                    borderColor: '#fff',
                    shadowBlur: 10,
                    shadowColor: 'rgba(0, 0, 0, 0.1)'
                },
                label: {
                    show: true,
                    formatter: '{b}',
                    fontSize: 14,
                    fontWeight: 'bold',
                    color: '#333'
                },
                emphasis: {
                    scale: true,
                    scaleSize: 15,
                    itemStyle: {
                        shadowBlur: 20,
                        shadowColor: 'rgba(0, 0, 0, 0.2)'
                    },
                    label: {
                        fontSize: 16,
                        color: '#2c7a53'
                    }
                },
                data: solarTermsData.map(term => ({
                    name: term.name,
                    value: 15,
                    season: term.season
                })),
                animationType: 'scale',
                animationEasing: 'elasticOut',
                animationDuration: 600
            }]
        };

        chart.setOption(option);
        window.addEventListener('resize', () => chart.resize());
    </script>
</body>

</html>